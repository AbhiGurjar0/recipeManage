<html>

<head>
    <meta charset="utf-8" />
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;600;700&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <style type="text/tailwindcss">
        :root {
        --primary-50: #fff7ed;
        --primary-100: #ffedd5;
        --primary-200: #fed7aa;
        --primary-300: #fdba74;
        --primary-400: #fb923c;
        --primary-500: #f97316;
        --primary-600: #ea580c;
        --primary-700: #c2410c;
        --primary-800: #9a3412;
        --primary-900: #7c2d12;
        --secondary-50: #f0fdf4;
        --secondary-100: #dcfce7;
        --secondary-200: #bbf7d0;
        --secondary-300: #86efac;
        --secondary-400: #4ade80;
        --secondary-500: #22c55e;
        --secondary-600: #16a34a;
        --secondary-700: #15803d;
        --secondary-800: #166534;
        --secondary-900: #14532d;
        --neutral-50: #fafaf9;
        --neutral-100: #f5f5f4;
        --neutral-200: #e7e5e4;
        --neutral-300: #d6d3d1;
        --neutral-400: #a8a29e;
        --neutral-500: #78716c;
        --neutral-600: #57534e;
        --neutral-700: #44403c;
        --neutral-800: #292524;
        --neutral-900: #1c1917;
      }
    </style>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <title>Recipe Management and Sharing Platform</title>
    <link href="data:image/x-icon;base64," rel="icon" type="image/x-icon" />
</head>

<body class="bg-primary-50" style='font-family: "Work Sans", sans-serif;'>
    <div class="relative flex size-full min-h-screen flex-col group/design-root overflow-x-hidden">
        <div class="layout-container flex h-full grow flex-col">
            <div class="w-full h-[10vh]">
                <%- include('partials/navbar') %>
            </div>
            <main class="flex-1 px-4 sm:px-6 lg:px-8 py-10 bg-gradient-to-br from-gray-50 to-white min-h-screen">
                <div class="max-w-7xl mx-auto">

                    <!-- Header -->
                    <div class="text-center mb-10">
                        <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900">Search Results</h1>
                        <p class="mt-3 text-lg text-neutral-600 max-w-2xl mx-auto">
                            Refine your query and explore delicious recipes.
                        </p>
                    </div>

                    <!-- Filter Form -->
                    <form id="filterForm" method="get" action="/user/search"
                        class="mb-10 flex flex-wrap gap-3 justify-center bg-white/70 backdrop-blur-md shadow-md p-4 rounded-2xl border border-gray-100">

                        <input type="text" name="ingredient" placeholder="Ingredient"
                            class="px-4 py-2 rounded-xl border border-gray-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm w-40 sm:w-48 transition" />

                        <input type="text" name="category" placeholder="Category"
                            class="px-4 py-2 rounded-xl border border-gray-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm w-40 sm:w-48 transition" />

                        <input type="number" name="minPrice" placeholder="Min Price"
                            class="px-1 py-2 rounded-xl border border-gray-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm w-28 transition" />

                        <input type="number" name="maxPrice" placeholder="Max Price"
                            class="px-4 py-2 rounded-xl border border-gray-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm w-28 transition" />

                        <button type="submit"
                            class="px-5 py-2 rounded-xl font-semibold text-black bg-primary-600 hover:bg-primary-700 shadow-md transition">
                            Apply Filters
                        </button>
                    </form>

                    <!-- Recipes Container -->
                    <div id="recipesContainer"></div>

                    <!-- Recipe Cards Grid -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-8">
                        <% recipe.forEach(function(product) { %>
                            <a href="/recipe/<%=product._id%>"
                                class="group bg-white shadow-md rounded-2xl overflow-hidden border border-gray-100 hover:shadow-xl hover:-translate-y-1 transition transform duration-300">

                                <!-- Image -->
                                <div class="relative">
                                    <% if (product.images && product.images.length> 0) { %>
                                        <img src="data:image/jpeg;base64,<%= product.images[0].toString('base64') %>"
                                            class="w-full h-44 sm:h-56 object-cover group-hover:scale-105 transition duration-300" />
                                        <% } else { %>
                                            <div
                                                class="w-full h-44 sm:h-56 flex items-center justify-center bg-gray-100 text-gray-500 text-sm">
                                                No Image
                                            </div>
                                            <% } %>

                                                <!-- Overlay badge -->
                                                <div
                                                    class="absolute top-3 left-3 bg-white/80 backdrop-blur-sm px-2.5 py-1 rounded-full text-xs font-medium text-gray-700 shadow">
                                                    <%= product.category %>
                                                </div>
                                </div>

                                <!-- Content -->
                                <div class="p-4 flex flex-col">
                                    <h2
                                        class="text-lg font-bold text-gray-800 truncate group-hover:text-primary-600 transition">
                                        <%= product.title %>
                                    </h2>


                                    <!-- Price -->
                                    <div class="mt-4 flex items-center justify-between">
                                        <span class="text-primary-600 font-semibold">â‚¹<%= product.price %></span>

                                    </div>
                                </div>
                            </a>
                            <% }) %>
                    </div>
                </div>
            </main>

        </div>
    </div>

</body>
<script>
    // document.getElementById('filterForm').addEventListener('submit', async (e) => {
    //     e.preventDefault();

    //     const formData = new FormData(e.target);
    //     const params = new URLSearchParams();

    //     for (const [key, value] of formData.entries()) {
    //         if (value) params.append(key, value);
    //     }
    //     console.log(params.toString());

    //     const response = await fetch("/user/search?" + params.toString())

    //     const data = await response.json();

    //     const container = document.getElementById('recipesContainer');
    //     container.innerHTML = '';

    //     if (data.recipes.length === 0) {
    //         container.innerHTML = '<p>No recipes found.</p>';
    //     } else {
    //         data.recipes.forEach(recipe => {
    //             const div = document.createElement('div');
    //             div.classList.add('recipe-card', 'p-4', 'border', 'rounded', 'mb-4');
    //             div.innerHTML = `
    //             <h2 class="text-xl font-bold">${recipe.title}</h2>
    //             <p>Price: ${recipe.price}</p>
    //             <p>Category: ${recipe.category}</p>
    //             <p>Ingredients: ${recipe.ingredients}</p>
    //         `;
    //             container.appendChild(div);
    //         });
    //     }
    // });

</script>

</html>